document.addEventListener("DOMContentLoaded",(()=>{let e="english",t=[];function n(e){const n=new XMLHttpRequest;n.open("GET",`/data/${e}.json`,!0),n.onload=function(){if(200===this.status){const e=JSON.parse(this.responseText);!function(e){for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];let o=null;const c=`[data-tag=${t}]`;t.endsWith("_image")&&(o=document.querySelector(c),console.log(o),o&&"img"===o.tagName.toLowerCase()&&(o.src=n)),t.endsWith("_category")?(o=document.querySelector(c),o.textContent=n,o.href=e["article-info_1_category_url"]):(o=document.querySelector(c),o&&(o.textContent=n))}}(e),t=function(e){const t=[],n=parseInt(e.total_cities_1_value,10)||0;for(let o=1;o<=n;o++){const n=`compare-tabs_1_city_${o}_aqi`,c=`compare-tabs_1_city_${o}_cigg`,r=e[`compare-tabs_1_city_${o}_name`],i=e[n],a=e[c];if(r&&i&&a){parseInt(i,10);const e=parseInt(a,10);t.push({name:r,aqi:i,cigg:isNaN(e)?0:e})}}return t}(e),function(e){const t=document.querySelector(".city-select");t.innerHTML='<option value="" disabled selected>Select a city</option>',e.forEach((e=>{const n=document.createElement("option");n.value=e.name,n.textContent=e.name,t.appendChild(n)}))}(t),o()}else console.error("Error in fetching data: ",this.status)},n.onerror=function(){console.error("Request error...")},n.send()}function o(){document.querySelector(".aqi-value").textContent="",document.querySelector(".cigarette-container").innerHTML=""}n(e),document.querySelector(".lang-toggle").addEventListener("click",(()=>{e="english"===e?"hindi":"english",n(e)})),document.querySelector(".city-select").addEventListener("change",(e=>{const n=e.target.value,c=t.find((e=>e.name===n));c&&function(e){o(),document.querySelector(".aqi-value").textContent=e.aqi;const t=document.querySelector(".cigarette-container");for(let n=0;n<e.cigg;n++){const e=document.createElement("img");e.src="/img/ciggrette_icon.png",e.alt=`cigarette ${n+1}`,e.classList.add("cigarette-icon"),t.appendChild(e)}}(c)}))}));